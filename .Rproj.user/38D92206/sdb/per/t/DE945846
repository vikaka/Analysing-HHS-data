{
    "contents" : "---\ntitle: 'Assignment #1 : Data exploration'\nauthor: \"Vishesh Kakarala\"\ndate: \"February 16, 2016\"\noutput: html_document\n---\n\n\n\n# Question 1 \n\n#### Part 1 :\n\nThe Office of Intergovernmental and External Affairs hosts ten Regional Offices that     directly serve state and local organizations. Each Regional Director ensures the Department maintains close contact with state, local, and tribal partners and addresses the needs of communities and individuals served through HHS programs and policies.\n[link]http://www.hhs.gov/about/agencies/regional-offices/\n\n#### Part 2:\n\n**HHS region  & states comparison**\n\n```{r}\nlibrary(XML)\nUS.Flu.Data <- read.csv(\"C:/Users/Vishesh Kakarala/Desktop/Foundations of data science/HW 1/US Flu Data.csv\")\nUS.Flu.Data$Date = as.Date(US.Flu.Data$Date, format = \"%m/%d/%Y\")\n```\n\n**Comparison between HHS region 2 and states -New york & New Jersey**\n\nIn order to compare, we plot the data from the HHS region and the states data.\n```{r}\nplot(US.Flu.Data$Date, US.Flu.Data$HHS.Region.2..NJ..NY.,main = \"HHS region 2 Vs States\", type = \"p\", col = \"blue\", pch = 20)\npoints(US.Flu.Data$Date, US.Flu.Data$New.York, col = \"yellow\", pch = 20)\npoints(US.Flu.Data$Date, US.Flu.Data$New.Jersey, col = \"red\", pch = 20)\n```\n\nThe states data is simlar to the HHS region except in the period from 2014 to 2016 where HHS region shows higher peak value and longer period of activity when compared to the state \nvalues.\n\nA similar comparison can be done for another HHS region\n\n**Comparison between HHS region 7 and State\n```{r}\nplot(US.Flu.Data$Date, US.Flu.Data$HHS.Region.7..IA..KS..MO..NE.,main = \"HHS region 7 Vs Iowa\", type = \"p\", col = \"blue\", pch = 20)\npoints(US.Flu.Data$Date, US.Flu.Data$Iowa, col = \"red\", pch = 20)\n```\n\n#### Part 3:\n\n**Grouping cities as States**\n```{r}\nState_cities <- data.frame(US.Flu.Data$Date)\ncolnames(State_cities) <- \"Date\"\nState_cities$Date = as.Date(State_cities$Date, format = \"%m/%d/%Y\")\n\nState_cities$Alaska <- US.Flu.Data$Anchorage..AK\nState_cities$Alabama <- US.Flu.Data$Birmingham..AL\nState_cities$Arkansas <- US.Flu.Data$Little.Rock..AR\nState_cities$Arizona <- apply(US.Flu.Data[,67:71],1,function(x) mean(x,na.rm = TRUE))\nState_cities$California <- apply(US.Flu.Data[,72:82],1,function(x) mean(x,na.rm = TRUE))\nState_cities$Colorado <- apply(US.Flu.Data[,83:84],1,function(x) mean(x,na.rm = TRUE))\nState_cities$Florida <- apply(US.Flu.Data[,86:90],1,function(x) mean(x,na.rm = TRUE))\nState_cities$Georgia <- apply(US.Flu.Data[,91:92],1,function(x) mean(x,na.rm = TRUE))\nState_cities$Hawaii <- US.Flu.Data$Honolulu..HI\nState_cities$Iowa <- US.Flu.Data$Des.Moines..IA\nState_cities$Idaho <- US.Flu.Data$Boise..ID\nState_cities$Illinois <- US.Flu.Data$Chicago..IL\nState_cities$Indiana <- US.Flu.Data$Indianapolis..IN\nState_cities$Kansas <- US.Flu.Data$Wichita..KS\nState_cities$Kentucky <- US.Flu.Data$Lexington..KY\nState_cities$Louisiana <- US.Flu.Data$Baton.Rouge..LA\n```\nFor comparing between the cities and states data we take an example of the state of Arizona and perform the comparison\n```{r echo =TRUE}\nsummary(US.Flu.Data$Arizona)\n\nsummary(State_cities$Arizona)\n```\nBy comparing the Descriptive statistics we find that there are no missing values, and the data from the two columns have similar central tendency and distribution of data can be visualised using a boxplot\n```{r echo = TRUE}\nboxplot(US.Flu.Data$Arizona,State_cities$Arizona, names = c(\"Arizona\",\"Cities Arizona\"),horizontal = TRUE)\n```\nUsing a box plot we can visually determine the distribution of data and median values of the two columns \n\nWhen we compare data from the cities of Alaska and the data of the entire State of Alaska\n```{r echo = TRUE}\nsummary(US.Flu.Data$Alaska)\n\nsummary(State_cities$Alaska)\n```\n\nwe find that there is missing data in both the columns.\n\nWe can populate missing data using interpolation, here Spline Interpolation is used to predict the missing values\n\n```{r warning= FALSE}\nAlaska_interpol <- splinefun(US.Flu.Data$Alaska, y = US.Flu.Data$date, method = \"periodic\")\nUS.Flu.Data$Alaska[1:63]<-Alaska_interpol(1:63)\n\nAlaska_cities_interpol <- splinefun(State_cities$Alaska, y = State_cities$date, method = \"periodic\")\nState_cities$Alaska[1:55]<-Alaska_interpol(1:55)\n```\nNatural Spline Interpolation is used because of the presence of one more cusps in the data,After we interpolate the missing data we can summarise the Data.\n\n```{r echo = TRUE}\n\nsummary(US.Flu.Data$Alaska)\n\nsummary(State_cities$Alaska)\n\nboxplot(US.Flu.Data$Alaska,State_cities$Alaska)\n```\nFrom the summary and the visual represntation we can find that the two columns of data have similar descriptive statistics.\n\n#### Part 4:\n\n**Design Two relevant Metrics**\n\nFirst Metric : *Month Wise average Flu search activity*\n\nUsing this metric we can track which month has the highest Flu search activity from the period Dec'03 to Aug'15. This metric will aid in identfying the peak month of Flu activity and help understand seasonality of FLU trends in the geographical region. we can compare this data with the month wise heirarchial aggregates to understand Seasonal trends. \n```{r fig.width= 10}\nmetric_1 <- data.frame(format(US.Flu.Data$Date, \"%b\"))\naggregate_metric <- aggregate(US.Flu.Data[,2:53],list(month=metric_1$format.US.Flu.Data.Date....b..),mean,na.rm = TRUE)  \nframe()\nplot(aggregate_metric$month, aggregate_metric$Oklahoma,main = \"Monthly Aggregate\",n= 1500,col = \"blue\", pch = 20)\npoints(aggregate_metric$month, aggregate_metric$California, col = \"red\", pch = 20) \n```\nWhile Jan and Feb are the seasonal months in Oklahoma, it is Dec and Jan in California\n\nSecond Metric : *weekly rate of Change*\n\nThis metric aids in understanding the movement of Flu trends on a weekly or monthly basis.\n\nHere we calculate weekly rate of change in the latest Year for the state of California\n```{r}\n\nweekly_change <- data.frame(c(1:32))\nfor(i in 1:32)\n{\n  \n  weekly_change[i,1]<- ((US.Flu.Data$California[i+588]- US.Flu.Data$California[i+588-1])/US.Flu.Data$California[i+588-1])*100\n  \n}\n\nweekly_change$date <- US.Flu.Data$Date[589:620]\nplot(weekly_change$date,weekly_change$c.1.32., type = \"l\")\n\n```\n\nThe plot shows the rate of change by months for the latest year in california, we can also calculate this information in a year wise distribution to understand changing trends.\n\n#### Part 5\n\nPopulation data - [link]http://www.census.gov/popest/data/state/totals/2015/index.html\n```{r}\npopulation_data <- read.csv(\"~/learning test/NST-EST2015-01.csv\")\nUS.Flu.Data.2015 <- US.Flu.Data[589:620,]  \nflu_max_2015 <- data.frame(apply(US.Flu.Data.2015[,3:53], 2,function(x) max(x)))  \nflu_max_2015$population <- population_data$Population.estimates.2015\ncolnames(flu_max_2015) <- c(\"Peak_2015\",\"Population_2015\")\n```\n\nFor Two Continous variables linear regression test is done to reject or fail to reject a null hypothesis\n```{r}\nsignificance.lm <- lm(flu_max_2015$Population_2015 ~ flu_max_2015$Peak_2015, data = flu_max_2015)\nsummary((significance.lm))\n```\nHere since p value is 0.797 , we fail to reject the null hypothesis and the result is statistically not significant\n\nWe analyze the scatter plot\n```{r}\nplot(flu_max_2015$Peak_2015,flu_max_2015$Population_2015, main = \"Population Vs Peak Flu trend value\", xlab = \"Peak flu Trend 2015\", ylab = \" Population 2015\")\n```\n\nFrom the scatter plot it is clear that higher population does not mean higher peak Flu trend value\n```{r}\ncor(flu_max_2015$Peak_2015,flu_max_2015$Population_2015)\n```\nThe correlation coefficient is negative i.e Peak flu value does not increase with increasing population\n\n# Question 2\n\nSource for Country wise central latitude\n[link]https://developers.google.com/public-data/docs/canonical/countries_csv\n```{r}\nworld_data <- read.csv(\"~/learning test/world_data.csv\")\nworld_data_2015 <- world_data[628:659,]\nflu_max <- data.frame(apply(world_data_2015[,2:30], 2,function(x) which.max(x)))\nrownames(flu_max) <- colnames(world_data_2015[2:30])\ncolnames(flu_max) <- \"Max_flu\"\nflu_max$Max_flu <- world_data_2015[c(flu_max$Max_flu),1]\nflu_max$Max_flu = as.Date(flu_max$Max_flu, format = \"%m/%d/%Y\")\n\nworld_lat <- read.csv(\"~/learning test/world_lat.csv\")\n\nrownames(world_lat) <- world_lat$name\n\nrownames(flu_max)[16]<- \"New Zealand\"\nrownames(flu_max)[28]<- \"United States\"\nrownames(flu_max)[23]<- \"South Africa\"\n\nflu_max$latitude <- world_lat[match(rownames(flu_max),rownames(world_lat)),]$latitude\n\nplot(flu_max$Max_flu,flu_max$latitude, main = \"Max week of Flu in 2015 Vs Central Latitude of countries\",xlab = \"Central Latitude\", ylab = \"Max week of Flu in 2015\", type = \"p\", col = \"blue\", pch = 20)\ntext(flu_max$Max_flu,flu_max$latitude,labels = row.names(flu_max),pos = 1)\n```\n\nIt is clear from the graph that Flu search trends are seasonal depending on the position of the countries latitude above or below the equator. With flu search trends increasing in the peak winter season in the northern hemisphere and in the peak summer months in the southern hemisphere.\n\n# Question 3 \n#### Part 1: \n**Reading vaccine status Data**\n```{r}\ntest_table <- readHTMLTable(\"http://www.cdc.gov/mmwr/preview/mmwrhtml/mm6401a4.htm?s_cid=mm6401\", header = TRUE, trim = TRUE)\ntable1 <- data.frame(test_table$`table-3`)\ntable1 = table1[-(1:3),]\ntable1 = table1[-38,]\ncolnames(table1) <- c(\"charecteristics\",\"Influenza_positive_no\",\"Influenza_positive_%\",\"Influenza_negative_no\",\"Influenza_negative_%\",\"Test_result_P_value\",\"vaccinated_status_no\",\"vaccinated_status_Total\",\"vaccinated_status_%\",\"vaccinated_status_pvalue\")\nrownames(table1) <- table1[,1]\ntable1<-table1[,-1]\n```\n#### Part 2:\n**Example of a similar table**  \n\nTable showing Drug overdose and deaths by by sex, age, race and Hispanic origin, Census region, and state —United States, 2013 and 2014\nFrom CDC's morbidity and mortality report(MMWR)-[link]http://www.cdc.gov/mmwr/preview/mmwrhtml/mm6450a3.htm?s_cid=mm6450a3_w\n```{r}\ntable_2 <- readHTMLTable(\"http://www.cdc.gov/mmwr/preview/mmwrhtml/mm6450a3.htm?s_cid=mm6450a3_w\")\ntable_2 <- table_2$`table-4`\n```\n\n",
    "created" : 1455626638089.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1891817539",
    "id" : "DE945846",
    "lastKnownWriteTime" : 1455834885,
    "path" : "~/HW 1/Assignment 1 - Vishesh Kakarala.Rmd",
    "project_path" : "Assignment 1 - Vishesh Kakarala.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_markdown"
}